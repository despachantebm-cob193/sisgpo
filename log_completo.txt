
> sisgpo-api@1.0.0 test
> npm run test:setup && dotenv -e .env -- jest --runInBand --detectOpenHandles


> sisgpo-api@1.0.0 test:setup
> knex migrate:latest --env test

Using environment: [35mtest[39m
[36mAlready up to date[39m
[Database] Conectando ao banco de dados do ambiente: TEST
[Global Setup] Iniciando configura√ß√£o do ambiente de teste...
[Global Setup] Limpando tabelas...
[Global Setup] Criando usu√°rio "admin" para os testes...
[Global Setup] Ambiente de teste configurado com sucesso.
PASS __tests__/integration/obm.test.js (5.985 s)
  ‚óè Console

    console.log
      [Database] Conectando ao banco de dados do ambiente: TEST

      at Object.log (src/config/database.js:27:9)

    console.log
      [AuthController] Buscando usu√°rio com login: admin

      at log (src/controllers/authController.js:15:13)

    console.log
      [AuthController] Usu√°rio encontrado: admin

      at log (src/controllers/authController.js:21:13)

    console.log
      [AuthController] A senha fornecida √© v√°lida? true

      at log (src/controllers/authController.js:30:13)

PASS __tests__/integration/plantao.test.js
  ‚óè Console

    console.log
      [Database] Conectando ao banco de dados do ambiente: TEST

      at Object.log (src/config/database.js:27:9)

    console.log
      [AuthController] Buscando usu√°rio com login: admin

      at log (src/controllers/authController.js:15:13)

    console.log
      [AuthController] Usu√°rio encontrado: admin

      at log (src/controllers/authController.js:21:13)

    console.log
      [AuthController] A senha fornecida √© v√°lida? true

      at log (src/controllers/authController.js:30:13)

PASS __tests__/integration/viatura.test.js
  ‚óè Console

    console.log
      [Database] Conectando ao banco de dados do ambiente: TEST

      at Object.log (src/config/database.js:27:9)

    console.log
      [AuthController] Buscando usu√°rio com login: admin

      at log (src/controllers/authController.js:15:13)

    console.log
      [AuthController] Usu√°rio encontrado: admin

      at log (src/controllers/authController.js:21:13)

    console.log
      [AuthController] A senha fornecida √© v√°lida? true

      at log (src/controllers/authController.js:30:13)

PASS __tests__/integration/militar.test.js
  ‚óè Console

    console.log
      [Database] Conectando ao banco de dados do ambiente: TEST

      at Object.log (src/config/database.js:27:9)

    console.log
      [AuthController] Buscando usu√°rio com login: admin

      at log (src/controllers/authController.js:15:13)

    console.log
      [AuthController] Usu√°rio encontrado: admin

      at log (src/controllers/authController.js:21:13)

    console.log
      [AuthController] A senha fornecida √© v√°lida? true

      at log (src/controllers/authController.js:30:13)

PASS __tests__/integration/dashboard.test.js
  ‚óè Console

    console.log
      [Database] Conectando ao banco de dados do ambiente: TEST

      at Object.log (src/config/database.js:27:9)

    console.log
      [AuthController] Buscando usu√°rio com login: admin

      at log (src/controllers/authController.js:15:13)

    console.log
      [AuthController] Usu√°rio encontrado: admin

      at log (src/controllers/authController.js:21:13)

    console.log
      [AuthController] A senha fornecida √© v√°lida? true

      at log (src/controllers/authController.js:30:13)

------------------------------------------|---------|----------|---------|---------|---------------------------------
File                                      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s               
------------------------------------------|---------|----------|---------|---------|---------------------------------
All files                                 |   49.01 |    33.33 |   46.34 |   49.29 |                                 
 controllers                              |   59.55 |    37.11 |   65.21 |   59.55 |                                 
  authController.js                       |   85.71 |       60 |     100 |   85.71 | 11,24,33                        
  dashboardController.js                  |   83.33 |      100 |     100 |   83.33 | 29-30                           
  militarController.js                    |   28.57 |     4.54 |      25 |   28.57 | 7-18,25,35-80                   
  obmController.js                        |   73.91 |    52.94 |      80 |   73.91 | 10-20,33,53,60,79,103           
  plantaoController.js                    |      50 |       15 |    62.5 |      50 | 20,37-38,49-127,142,159-160,174 
  viaturaController.js                    |   68.57 |    60.71 |      75 |   68.57 | 10-21,31,49,56,85               
 database/migrations                      |       0 |      100 |       0 |       0 |                                 
  20250826000000_create_initial_schema.js |       0 |      100 |       0 |       0 | 5-71                            
 middlewares                              |   44.82 |    33.33 |      40 |   48.14 |                                 
  authMiddleware.js                       |   76.47 |       50 |     100 |   76.47 | 10,17,23,30                     
  validationMiddleware.js                 |       0 |        0 |       0 |       0 | 1-23                            
 routes                                   |     100 |      100 |     100 |     100 |                                 
  authRoutes.js                           |     100 |      100 |     100 |     100 |                                 
 utils                                    |    4.16 |        0 |       0 |    4.16 |                                 
  QueryBuilder.js                         |    4.16 |        0 |       0 |    4.16 | 21-62                           
 validators                               |      88 |       50 |   66.66 |    91.3 |                                 
  militarValidator.js                     |     100 |      100 |     100 |     100 |                                 
  obmValidator.js                         |     100 |      100 |     100 |     100 |                                 
  plantaoValidator.js                     |     100 |      100 |     100 |     100 |                                 
  validationMiddleware.js                 |   66.66 |       50 |   66.66 |   71.42 | 5-10                            
  viaturaValidator.js                     |     100 |      100 |     100 |     100 |                                 
------------------------------------------|---------|----------|---------|---------|---------------------------------

Test Suites: 5 passed, 5 total
Tests:       10 passed, 10 total
Snapshots:   0 total
Time:        10.172 s
Ran all test suites.
[Global Teardown] Encerrando a conex√£o com o banco de dados...
[Global Teardown] Conex√£o com o banco de dados encerrada.
